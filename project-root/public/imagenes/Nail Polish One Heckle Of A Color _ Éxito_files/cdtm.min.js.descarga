!function(e){"use strict";var t=624,i=397,n=2147483648,o=2147483647,r=new(function(){function e(e){void 0===e&&(e=(new Date).getTime()),this.mt=new Array(t),this.mti=625,this.initSeed(e)}return e.prototype.initSeed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<t;this.mti++){var i=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&i)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.randomInt=function(){var e,r=[0,2567483615];if(this.mti>=t){var a=0;for(625==this.mti&&this.initSeed((new Date).getTime());a<227;a++)e=this.mt[a]&n|this.mt[a+1]&o,this.mt[a]=this.mt[a+i]^e>>>1^r[1&e];for(;a<623;a++)e=this.mt[a]&n|this.mt[a+1]&o,this.mt[a]=this.mt[a+(i-t)]^e>>>1^r[1&e];e=this.mt[623]&n|this.mt[0]&o,this.mt[623]=this.mt[396]^e>>>1^r[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random=function(){return this.randomInt()*(1/4294967296)},e}())(Math.random()*Number.MAX_SAFE_INTEGER);var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","-","_"];for(var u=[],p=0;p<256;++p)u.push((p+256).toString(16).substr(1));var l=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function c(e,t){void 0===t&&(t=0);var i=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&l.test(e)}(i))throw TypeError("Stringified UUID is invalid");return i}function d(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var i=new Uint8Array(16);return function(e){for(var t=e.length;t--;)e[t]=Math.floor(256*r.random())}(i),i[6]=15&i[6]|64,i[8]=63&i[8]|128,e?function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1);for(var n="",o=2,r=e.length,u=i?s:a;o<r;o+=3)n+=u[e[o-2]>>2],n+=u[(3&e[o-2])<<4|e[o-1]>>4],n+=u[(15&e[o-1])<<2|e[o]>>6],n+=u[63&e[o]];return o===r+1&&(n+=u[e[o-2]>>2],n+=u[(3&e[o-2])<<4],t&&(n+="==")),o===r&&(n+=u[e[o-2]>>2],n+=u[(3&e[o-2])<<4|e[o-1]>>4],n+=u[(15&e[o-1])<<2],t&&(n+="=")),n}(i,!1,t):c(i)}var f,h=function(){function e(e){this._c=e,this._vars={},this._values={}}return e.prototype.addVariable=function(e,t){this._vars[e]=(Array.isArray(t)||!t&&0!==t?t:[t])||(this._c.value.noConsentManagement?[0]:[])},e.prototype.addVariableBulk=function(e,t){for(var i=0,n=t;i<n.length;i++){var o=n[i];this.addVariable(o,e)}},e.prototype.isVariableRegistered=function(e){return!!this._vars[e]},e.prototype.getVariableScopes=function(e){return this._vars[e]||[]},e.prototype._assertVariableRegistration=function(e){return this._c.value.noConsentManagement?(this.addVariable(e,null),!0):!!this.isVariableRegistered(e)||(console.error("Variable "+e+" is not registered"),!1)},e.prototype.setValue=function(e,t){this._assertVariableRegistration(e)&&(this._values[e]=t)},e.prototype.setValueBulk=function(e){for(var t in e)this.setValue(t,e[t])},e.prototype.getValue=function(e){return this._assertVariableRegistration(e)?this._values[e]:null},e.prototype.setVariable=function(e,t,i){this.addVariable(e,t),this.setValue(e,i)},e.prototype.setVariableBulk=function(e,t){for(var i in t)this.setVariable(i,e,t[i])},e.prototype.deleteVariable=function(e){delete this._vars[e],delete this._values[e]},e.prototype.getAllowedVariables=function(e){var t=this;return Object.entries(this._vars).filter((function(i){for(var n=0,o=e;n<o.length;n++){var r=o[n];if(-1!==i[1].indexOf(r)&&i[0]in t._values&&void 0!==t._values[i[0]])return!0}return!1})).map((function(e){return{name:e[0],scopes:e[1],value:t._values[e[0]]}}))},e}(),g=function(){function e(e){this._val=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._val},set:function(e){this._val=e},enumerable:!1,configurable:!0}),e}();function S(e){return!!e&&0===e.indexOf("@@")}function v(e){return"@@"+e.value.length+"@@"+e.value+"|"+e.expiration.getTime()}function y(e){var t=e.substr(2).split("@@",2)[0],i=+t;return isNaN(i)||"|"!==e.substr(4+t.length+i,1)?null:{value:e.substr(4+t.length,i),expiration:new Date(+e.substring(4+t.length+i+1))}}function mc(e,t,i,n,o){var r=function(){var e=document.domain||window.location.hostname;if(!e||!e.includes("."))return null;var t=e.split(".");if(t.length<2)return null;return"."+t.slice(-2).join(".")}(),a=e+"="+(t||"");return a+=r?";path="+i+";domain="+r:";path="+i,n&&(a+=";expires="+n.toUTCString()),o&&(a+=";secure"),a}function m(e,t){for(var i=0,n=t;i<n.length;i++){var o=n[i];if(-1===e.indexOf(o))return!1}return!0}function E(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(!e||!e.length)return null;for(var o=[],r=0,a=e;r<a.length;r++){(c=a[r]).isAvailable()&&m(c.allowedStorageTypes(),i)&&o.push(c)}for(var s=-1,u=null,p=0,l=o;p<l.length;p++){var c,d=(c=l[p]).usageAffinities()[t]||0;d<0||d>s&&(s=d,u=c)}return u}e.StorageType=void 0,(f=e.StorageType||(e.StorageType={}))[f.SESSION=0]="SESSION",f[f.PERSISTENT=1]="PERSISTENT";var I,T=function(){function t(){}return Object.defineProperty(t.prototype,"localStorageSupported",{get:function(){return"undefined"!=typeof localStorage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionStorageSupported",{get:function(){return"undefined"!=typeof sessionStorage},enumerable:!1,configurable:!0}),t.prototype.usageAffinities=function(){return{visitorId:5,sessionData:10}},t.prototype.isAvailable=function(){return this.localStorageSupported||this.sessionStorageSupported},t.prototype.allowedStorageTypes=function(){var t=[];return this.localStorageSupported&&t.push(e.StorageType.PERSISTENT),this.sessionStorageSupported&&t.push(e.StorageType.SESSION),t},t.prototype.get=function(t,i){var n;return(n=i===e.StorageType.PERSISTENT?localStorage.getItem(t):sessionStorage.getItem(t))&&S(n)?y(n):n},t.prototype.store=function(t,i,n){t&&(null!==i?("string"!=typeof i&&(i=v(i)),n===e.StorageType.PERSISTENT?localStorage.setItem(t,i):sessionStorage.setItem(t,i)):this.remove(t,n))},t.prototype.remove=function(t,i){i===e.StorageType.PERSISTENT?localStorage.removeItem(t):sessionStorage.removeItem(t)},t.prototype.clear=function(){localStorage.clear(),sessionStorage.clear()},t}(),b=function(){function t(e,t,i,n){this.path=e,this.secure=t,this.persistenceSingleCookie=i,this.sessionSingleCookie=n}return t.prototype.usageAffinities=function(){return{visitorId:10,sessionData:5}},t.prototype.allowedStorageTypes=function(){return[e.StorageType.PERSISTENT,e.StorageType.SESSION]},t.prototype.isAvailable=function(){return"undefined"!=typeof document&&void 0!==document.cookie},t.parseCookies=function(){for(var e={},t=0,i=decodeURIComponent(document.cookie).split(";");t<i.length;t++){var n=i[t],o=n.indexOf("=");-1!==o&&(e[n.substring(0,o).trim()]=n.substr(o+1).trim())}return e},t.prototype.cookieNameFromType=function(t){switch(t){case e.StorageType.PERSISTENT:return this.persistenceSingleCookie;case e.StorageType.SESSION:return this.sessionSingleCookie}return null},t.prototype.isSingleCookie=function(e){return!!this.cookieNameFromType(e)},t.getMultiCookieValue=function(e){return S(e)?y(e):"string"!=typeof e?null:e},t.expirationYear=function(){var e=new Date;return e.setFullYear(e.getFullYear()+1),e},t.prototype.get=function(i,n){if(!i)return null;var o=t.parseCookies();if(!this.isSingleCookie(n)){var r=n===e.StorageType.SESSION?"s":"";return t.getMultiCookieValue(o[r+i])}var a=o[this.cookieNameFromType(n)]||"",s=-1;if(a&&(s=a.indexOf(i+"=")),-1===s)return null;var u=a.indexOf("||",s+3);-1===u&&(u=a.length);var p=a.substring(s+i.length+1,u);return S(p)?y(p):p},t.removeOldValue=function(e,t){var i=e.indexOf("||",t+3);return-1===i&&(i=e.length),0===(e=e.substring(0,t)+e.substring(i)).indexOf("||")&&(e=e.substr(2)),e},t.prototype.remove=function(i,n){if(this.isSingleCookie(n)){var o=t.parseCookies(),r=this.cookieNameFromType(n),a=o[r]||"",s=-1;a&&0!==(s=a.indexOf(i+"="))&&(s=a.indexOf("||"+i+"=")),-1!==s&&(a=t.removeOldValue(a,s),this.createCookie(r,a,n===e.StorageType.SESSION?null:t.expirationYear()))}else{var u=n===e.StorageType.SESSION?"s":"";this.createCookie(u+i,"",new Date)}},t.prototype.store=function(i,n,o){if(null!==n)if(this.isSingleCookie(o)){var r=t.parseCookies(),a=this.cookieNameFromType(o),s=r[a]||"";"string"!=typeof n&&(n=v(n));var u=-1;s&&0!==(u=s.indexOf(i+"="))&&(u=s.indexOf("||"+i+"=")),-1!==u&&(s=t.removeOldValue(s,u)),s&&(s+="||"),s+=i+"="+n,this.createCookie(a,s,o===e.StorageType.SESSION?null:t.expirationYear())}else{var p=new Date;p.setFullYear(p.getFullYear()+1),"string"!=typeof n&&(p=n.expiration,n=v(n));var l=o===e.StorageType.SESSION?"s":"";this.createCookie(l+i,n,o===e.StorageType.SESSION?null:p)}else this.remove(i,o)},t.prototype.createCookie=function(e,t,i){document.cookie=mc(e,encodeURIComponent(t),this.path,i,this.secure)},t.prototype.clear=function(){var i=this,n=this.isSingleCookie(e.StorageType.PERSISTENT),o=this.isSingleCookie(e.StorageType.SESSION),r=Object.keys(t.parseCookies());n&&Object.values(t.parseCookies())[0].split("||").forEach((function(t){i.remove(t.substr(0,t.indexOf("=")),e.StorageType.PERSISTENT)}));o&&Object.values(t.parseCookies())[1].split("||").forEach((function(t){i.remove(t.substr(0,t.indexOf("=")),e.StorageType.SESSION)}));r.forEach((function(t){n||i.remove(t,e.StorageType.PERSISTENT),o||i.remove(t,e.StorageType.SESSION)}))},t}(),_=function(){function t(){this.persistentData={},this.sessionData={}}return t.prototype.usageAffinities=function(){return{}},t.prototype.allowedStorageTypes=function(){return[e.StorageType.SESSION,e.StorageType.PERSISTENT]},t.prototype.isAvailable=function(){return!0},t.prototype.get=function(t,i){return i===e.StorageType.PERSISTENT&&t in this.persistentData?this.persistentData[t]:i===e.StorageType.SESSION&&t in this.sessionData?this.sessionData[t]:null},t.prototype.remove=function(t,i){i===e.StorageType.PERSISTENT&&delete this.persistentData[t],i===e.StorageType.SESSION&&delete this.sessionData[t]},t.prototype.store=function(t,i,n){t&&(n===e.StorageType.PERSISTENT&&(this.persistentData[t]=i),n===e.StorageType.SESSION&&(this.sessionData[t]=i))},t.prototype.clear=function(){this.persistentData={},this.sessionData={}},t}(),N=function(){function t(e,t){void 0===t&&(t="tcId"),this.storage=e,this.prefix=t}return t.prototype.getVisitorId=function(t){if("string"!=typeof t)return null;var i=this.storage.get(this.prefix+t,e.StorageType.PERSISTENT);return i?"string"==typeof i?{value:i,expiration:new Date}:i:null},t.prototype.storeVisitorId=function(t,i){"string"==typeof t&&(i?this.storage.store(this.prefix+t,i,e.StorageType.PERSISTENT):this.storage.remove(this.prefix+t,e.StorageType.PERSISTENT))},t}(),C=function(){function t(e){this._config=e,this._currentPageData={}}return t.prototype._getStorage=function(){var t=E(this._config.value.storage,"sessionData",e.StorageType.SESSION);return null===t&&(console.warn("Cannot find an appropriate session storage interface implementation, defaulting to noop"),t=new _,this._config.value.storage.push(t)),t},t.prototype.getPreviousPageValue=function(t){if(!t)return null;var i=this._getStorage().get(t,e.StorageType.SESSION);return null===i?null:"object"==typeof i?i.value:i},t.prototype.getCurrentPageValue=function(e){return e?void 0===this._currentPageData[e]?null:this._currentPageData[e].value:null},t.prototype.setValue=function(e,t,i){void 0===i&&(i=!1),e&&(this._currentPageData[e]={value:t,sticky:i})},t.prototype.deleteValue=function(e){e&&delete this._currentPageData[e]},t.prototype.clearCurrentPage=function(){this._currentPageData={}},t.prototype.clearPreviousPage=function(){this._getStorage().clear()},t.prototype.writeCurrentPageData=function(){var t=this._getStorage(),i=t.get("_nsv",e.StorageType.SESSION);"string"==typeof i&&i.split(",").forEach((function(i){return t.remove(i,e.StorageType.SESSION)}));for(var n=[],o=0,r=Object.keys(this._currentPageData);o<r.length;o++){var a=r[o];this._currentPageData[a].sticky||n.push(a)}t.store("_nsv",n.join(",")||null,e.StorageType.SESSION);for(var s=0,u=Object.getOwnPropertyNames(this._currentPageData);s<u.length;s++){a=u[s];t.store(a,this._currentPageData[a].value,e.StorageType.SESSION)}this.clearCurrentPage()},t}();!function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PASSIVE=1]="PASSIVE",e[e.HIDDEN=2]="HIDDEN",e[e.FROZEN=3]="FROZEN",e[e.TERMINATED=4]="TERMINATED"}(I||(I={}));var k="object"==typeof safari&&safari.pushNotification,V=[[I.ACTIVE,I.PASSIVE,I.HIDDEN,I.TERMINATED],[I.ACTIVE,I.PASSIVE,I.HIDDEN,I.FROZEN],[I.HIDDEN,I.PASSIVE,I.ACTIVE],[I.FROZEN,I.HIDDEN],[I.FROZEN,I.ACTIVE],[I.FROZEN,I.PASSIVE]].map((function(e){return e.reduce((function(e,t,i){return e[t]=i,e}),{})})),O=function(){return"hidden"===document.visibilityState?I.HIDDEN:document.hasFocus()?I.ACTIVE:I.PASSIVE},w=function(){function e(){var e=this;this._listeners=[],"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.hasFocus&&(this._state=O(),this._handleEvents=this._handleEvents.bind(this),["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in window?"pagehide":"unload"].forEach((function(t){return addEventListener(t,e._handleEvents,!0)})),k&&addEventListener("beforeunload",(function(t){e._safariBeforeUnloadTimeout=setTimeout((function(){t.defaultPrevented||t.returnValue.length>0||e._dispatchChangesIfNeeded(t,I.HIDDEN)}),0)})))}return e.prototype.addEventListener=function(e){-1===this._listeners.indexOf(e)&&this._listeners.push(e)},e.prototype._dispatchEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.removeEventListener=function(e){var t=this._listeners.indexOf(e);-1!==t&&(this._listeners=this._listeners.splice(t,1))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype._dispatchChangesIfNeeded=function(e,t){if(t!==this._state)for(var i=function(e,t){for(var i=0,n=V;i<n.length;i++){var o=n[i],r=o[e],a=o[t];if(r>=0&&a>=0&&a>r)return Object.keys(o).map((function(e){return+e})).slice(r,a+1)}return[]}(this._state,t),n=0;n<i.length-1;++n){var o=i[n],r=i[n+1];this._state=r,this._dispatchEvent({oldState:o,newState:r,originalEvent:e})}},e.prototype._handleEvents=function(e){switch(k&&clearTimeout(this._safariBeforeUnloadTimeout),e.type){case"pageshow":case"resume":this._dispatchChangesIfNeeded(e,O());break;case"focus":this._dispatchChangesIfNeeded(e,I.ACTIVE);break;case"blur":this._state===I.ACTIVE&&this._dispatchChangesIfNeeded(e,O());break;case"pagehide":case"unload":this._dispatchChangesIfNeeded(e,e.persisted?I.FROZEN:I.TERMINATED);break;case"visibilitychange":this._state!==I.FROZEN&&this._state!==I.TERMINATED&&this._dispatchChangesIfNeeded(e,O());break;case"freeze":this._dispatchChangesIfNeeded(e,I.FROZEN)}},e}(),P=["url","ref","locale","pageId","lastPageId","originType","clickId","clickName"];function D(e){return e instanceof HTMLAnchorElement||e instanceof HTMLButtonElement}function R(e){return function(t){for(var i=t.target;!D(i)&&i.parentElement;)i=i.parentElement;if(D(i)){if(e.options.trackClickOnLinks&&i instanceof HTMLAnchorElement){var n=i.href,o=e.options.analyzeLinkOnClick(n);"ignored"!==o&&e.options.prepareClickOnLinkMessage(o,n)}var r=(i.attributes.getNamedItem("objectid")||{value:""}).value||i.innerText||(i.attributes.getNamedItem("alt")||{value:""}).value||i.title||(i.attributes.getNamedItem("src")||{value:""}).value||(i.attributes.getNamedItem("action")||{value:""}).value,a=i.innerText||i.title||(i.attributes.getNamedItem("action")||{value:""}).value;e.clickHandler("clickId",r),e.clickHandler("clickName",a)}}}var x,A=function(){function t(e){this.Scopes={ESSENTIAL:0,NON_ESSENTIAL:1},this.Storages={COOKIE:b,BROWSER_STORAGE:T,IN_MEMORY:_},this._options=new g(this.createDefaultOptions()),this._sessionData=new C(this._options),this.metadatas={},this._bhr=!1,this._containers={},this._hooks=[],this._inFlight=!1,this._nextCallChain=[],e&&this.configure(e),this.onPageLoad()}return t.prototype.createDefaultOptions=function(){return{partnerId:"",includeScopes:!0,serverSideTcId:!0,expirationDays:365,storage:[new b("/",!0,null,"cdtSess"),new T],noConsentManagement:!1,visitorIdKeyPrefix:"tcId",serverSideVisitorIdCookieName:"tcId",registerBrowserLifecycleHooks:!1,idGenerator:d,pageChangeTimeout:100,trackClickOnLinks:!1}},t.prototype.onPageLoad=function(){this._sessionData.setValue("pId",d())},t.prototype.onPageUnload=function(){this._sessionData.writeCurrentPageData()},Object.defineProperty(t.prototype,"browserLifecycleHooksRegistered",{get:function(){return this._bhr},enumerable:!1,configurable:!0}),t.prototype.registerBrowserLifecycleHooks=function(){var e=this;if("undefined"!=typeof window&&"undefined"!=typeof document&&!this._bhr){var t=new w;this.metadatas.browserLifecycle=t,t.addEventListener((function(t){t.newState===I.TERMINATED&&e.onPageUnload()})),this._bhr=!0}},Object.defineProperty(t.prototype,"options",{get:function(){return this._options.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optionsReference",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionData",{get:function(){return this._sessionData},enumerable:!1,configurable:!0}),t.prototype.clickHandler=function(e,t){var i=this;null===t?t=this.generateId():"function"==typeof t&&(t=t()),t&&(this.sessionData.setValue(e,t),setTimeout((function(){i.sessionData.deleteValue(e)}),this.options.pageChangeTimeout))},t.prototype.getContainer=function(e){return this._containers[e]||(this._containers[e]=new h(this._options)),this._containers[e]},t.prototype.clearContainer=function(e){this._containers[e]=new h(this._options)},t.prototype.clearAllContainers=function(){this._containers={}},t.prototype.configure=function(e){e||(e={partnerId:""});var t=this.createDefaultOptions();this._options.value={partnerId:e.partnerId||t.partnerId,includeScopes:"boolean"==typeof e.includeScopes?e.includeScopes:t.includeScopes,serverSideTcId:"boolean"==typeof e.serverSideTcId?e.serverSideTcId:t.serverSideTcId,expirationDays:e.expirationDays||t.expirationDays,storage:e.storage||t.storage,idGenerator:e.idGenerator||t.idGenerator,visitorIdKeyPrefix:e.visitorIdKeyPrefix||t.visitorIdKeyPrefix,registerBrowserLifecycleHooks:"boolean"==typeof e.registerBrowserLifecycleHooks?e.registerBrowserLifecycleHooks:t.registerBrowserLifecycleHooks,noConsentManagement:"boolean"==typeof e.noConsentManagement?e.noConsentManagement:t.noConsentManagement,pageChangeTimeout:e.pageChangeTimeout||t.pageChangeTimeout,trackClickOnLinks:e.trackClickOnLinks||t.trackClickOnLinks,analyzeLinkOnClick:null==e?void 0:e.analyzeLinkOnClick,prepareClickOnLinkMessage:null==e?void 0:e.prepareClickOnLinkMessage},this._options.value.noConsentManagement&&(this._options.value.includeScopes=!1),this._options.value.registerBrowserLifecycleHooks&&this.registerBrowserLifecycleHooks()},t.prototype.addVariable=function(e,t,i){void 0===i&&(i="main"),this.getContainer(i).addVariable(e,t)},t.prototype.addVariableBulk=function(e,t,i){void 0===i&&(i="main"),this.getContainer(i).addVariableBulk(e,t)},t.prototype.setValue=function(e,t,i){void 0===i&&(i="main"),this.getContainer(i).setValue(e,t)},t.prototype.setValueBulk=function(e,t){void 0===t&&(t="main"),this.getContainer(t).setValueBulk(e)},t.prototype.getValue=function(e,t){return void 0===t&&(t="main"),this.getContainer(t).getValue(e)},t.prototype.setVariable=function(e,t,i,n){void 0===n&&(n="main"),this.getContainer(n).setVariable(e,t,i)},t.prototype.setIdVariable=function(e,t,i){void 0===i&&(i="main"),this.setVariable(e,t,this.generateId(),i)},t.prototype.setPreviousPageVariable=function(e,t,i,n){void 0===n&&(n="main");var o=this.sessionData.getPreviousPageValue(t);null!==o&&this.setVariable(e,i,o,n)},t.prototype.setVariableBulk=function(e,t,i){void 0===i&&(i="main"),this.getContainer(i).setVariableBulk(e,t)},t.prototype.isVariableRegistered=function(e,t,i){void 0===t&&(t="main"),void 0===i&&(i=!0);var n=this.getContainer(t).isVariableRegistered(e);return!n&&i?this.getContainer("global").isVariableRegistered(e):n},t.prototype.getVariableScopes=function(e,t,i){void 0===t&&(t="main"),void 0===i&&(i=!0);var n=this.getContainer(t).getVariableScopes(e);return n&&n.length||!i?n:this.getContainer("global").getVariableScopes(e)},t.prototype.setCommonVariables=function(e,t,i){void 0===t&&(t="main"),void 0===i&&(i=!1),function(e,t,i,n){if(void 0===i&&(i="main"),void 0===n&&(n=!1),t){var o=t;!0===t.url&&"undefined"!=typeof window&&(o.url=window.location.href),!0===t.ref&&"undefined"!=typeof document&&(o.ref=document.referrer),!0===t.locale&&"undefined"!=typeof navigator&&(o.locale=(navigator.languages||[navigator.language])[0]),!0===t.pageId&&(o.pageId=e.sessionData.getCurrentPageValue("pId")),!0===t.lastPageId&&(o.lastPageId=e.sessionData.getPreviousPageValue("pId")),!0===t.originType&&(o.originType=e.sessionData.getPreviousPageValue("ot")),!0===t.clickId&&(o.clickId=e.sessionData.getPreviousPageValue("clickId")),!0===t.clickName&&(o.clickName=e.sessionData.getPreviousPageValue("clickName"));for(var r=0,a=P;r<a.length;r++){var s=a[r];"boolean"==typeof o[s]&&(!1===o[s]&&e.getContainer(i).deleteVariable(s),delete o[s])}for(var u=0,p=Object.keys(t);u<p.length;u++){var l=p[u],c=o[l];c&&e.setVariable(l,[0,1],c,i)}n&&t.type&&e.sessionData.setValue("ot",t.type)}}(this,e,t,i)},t.prototype.collectExperimentalVariables=function(e,t){void 0===t&&(t="main"),function(e,t,i){if(void 0===i&&(i="main"),t&&t.collectNetworkApiInfos&&"undefined"!=typeof window&&void 0!==window.navigator){var n=window.navigator.connection;e.setVariable("isNetInfosSupported",[0,1],void 0!==n,i),void 0!==n&&n.type&&e.setVariable("connectionType",[0,1],n.type,i)}}(this,e,t)},t.prototype.addHook=function(e){this._hooks.push(e)},t.prototype.addConsentedCategories=function(e,t,i){void 0===i&&(i="global");var n=this.getContainer(i);n.isVariableRegistered(e)||n.addVariable(e,[this.Scopes.ESSENTIAL,this.Scopes.NON_ESSENTIAL]),n.setValue(e,t)},t.prototype.addConsentedVendors=function(e,t,i){void 0===i&&(i="global");var n=this.getContainer(i);n.isVariableRegistered(e)||n.addVariable(e,[this.Scopes.ESSENTIAL,this.Scopes.NON_ESSENTIAL]),n.setValue(e,t)},t.prototype.generateId=function(){return this.options.idGenerator?this.options.idGenerator():d()},t.prototype.handleClicks=function(){"undefined"!=typeof document?document.addEventListener("click",R(this)):console.error("Cannot register clickId handler in a non browser environment")},t.prototype._getVisitorId=function(t){if(!this._visIdStorage){var i=E(this.options.storage,"visitorId",e.StorageType.PERSISTENT);null==i&&(console.warn("Cannot find an appropriate storage interface implementation, defaulting to noop"),i=new _),this._visIdStorage=new N(i,this.options.visitorIdKeyPrefix)}var n=this._visIdStorage.getVisitorId(t);if(!n||!n.expiration||(new Date).getTime()>=n.expiration.getTime()){var o=new Date;o.setTime((new Date).getTime()+24*this.options.expirationDays*60*60*1e3),n={value:this.generateId(),expiration:o},this._visIdStorage.storeVisitorId(t,n)}return n.value},t.prototype._addContainerToMessage=function(e,t,i){this.getContainer(e).getAllowedVariables(t).forEach((function(e){i[e.name]=function(e){return{scopes:e.scopes,value:e.value}}(e)}))},t.prototype.prepareMessage=function(e,t,i){var n=this;if(void 0===t&&(t="main"),void 0===i&&(i=!0),!e||!e.length){if(!this.options.noConsentManagement)throw new Error("No authorized scopes provided, you need at least one to send the message");e=[0]}this.options.partnerId||console.warn("No partnerId provided, the server will probably reject the message");var o={},r="string"==typeof t?[t]:t;i&&r.splice(0,0,"global"),r.forEach((function(t){n._addContainerToMessage(t,e,o)})),this.options.partnerId&&(o._partnerId={scopes:[this.Scopes.ESSENTIAL,this.Scopes.NON_ESSENTIAL],value:this.options.partnerId}),this.options.serverSideTcId||(-1!==e.indexOf(this.Scopes.ESSENTIAL)&&(o._vId={scopes:[this.Scopes.ESSENTIAL],value:this._getVisitorId("E")}),-1!==e.indexOf(this.Scopes.NON_ESSENTIAL)?o._vIdNe={scopes:[this.Scopes.NON_ESSENTIAL],value:this._getVisitorId("Ne")}:this._visIdStorage.storeVisitorId("Ne",void 0));for(var a=0,s=this._hooks;a<s.length;a++){var u=(0,s[a])(o);u&&(o=u)}if(!this.options.includeScopes)for(var p=0,l=Object.keys(o);p<l.length;p++){var c=l[p];o[c]=o[c].value}return o},t.prototype.sendPromise=function(e,t){var i=this;if("undefined"==typeof Promise)throw new Error("Promises are not available");return new Promise((function(n,o){i.send(e,t,n,o)}))},t.prototype.runCallChain=function(){var e=this._nextCallChain;this._nextCallChain=[],e.forEach((function(e){return e()}))},t.prototype.send=function(e,t,i,n,o,r){var a,s=this;if(void 0===o&&(o="main"),void 0===r&&(r=!0),"undefined"==typeof XMLHttpRequest)throw new Error("XMLHttpRequest not supported on this platform");if(this._inFlight&&this.options.serverSideTcId&&"undefined"!=typeof document&&-1===document.cookie.indexOf("tcId"))return this._nextCallChain.push((function(){return s.send(e,t,i,n,o,r)})),!0;try{a=this.prepareMessage(t,o,r)}catch(e){return n({httpStatus:0,exception:e}),!1}this._inFlight=!0;var u=new XMLHttpRequest;return u.addEventListener("load",(function(){s._inFlight=!1,i(),s.runCallChain()})),u.addEventListener("error",(function(){s._inFlight=!1;var e=null;if(u.responseText)try{e=JSON.parse(u.responseText)}catch(e){}n({httpStatus:u.status,httpResponse:e}),s.runCallChain()})),u.open("POST",e),u.withCredentials=!0,u.setRequestHeader("content-type","text/plain"),u.send(JSON.stringify(a)),!1},t}(),L=new A;"undefined"!=typeof window&&(window.cdtm=L,"function"==typeof Event?x=new Event("cdtmLoaded"):(x=document.createEvent("Event")).initEvent("cdtmLoaded",!0,!0),window.dispatchEvent(x));e.BrowserStorage=T,e.CdtmLib=A,e.CookieStorage=b,e.InMemoryStorage=_,e.cdtm=L,Object.defineProperty(e,"__esModule",{value:!0})}({});